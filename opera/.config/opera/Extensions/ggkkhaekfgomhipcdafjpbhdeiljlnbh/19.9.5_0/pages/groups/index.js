cjModules.define(function(){"use strict";return function(e,n){function c(c){return new Promise(function(a){var t=S;c&&"public"!==c&&(t+="/a/"+c),t+="/forum";var i=cjBasics.urlParams.attach(t,{bm_cid:"groups",bm_xfo:n.sid,authuser:n.account.authuser})+"#!myforums",o=bmElements.createElement("iframe",{dataIframe:!0,src:i,sandbox:"allow-forms allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation",onMessage:function(e){var n=e.bm_method,c=e.bm_value;"groupsData"===n&&(o.remove(),o.src="about:blank",o=null,a(c))}});e.appendChild(o)})}function a(e){if(N!==e){b.cjceToggle(!1),f.cjceToggle(!1);var c="search"===e;w.hidden=c,E.hidden=!c,C.hidden="myforums"!==e,h.cjceSetBackState(c),g.cjceSetCollapseState(c),"search"!==N&&(T=N),c?E.select():(h.cjceSetPageLabel(A[e]),cjgApis.cache.setItem(n.account,"bm_cache_v05__groups__lastused",e)),N=e,p.textContent="",v&&s()}}function t(){var e=bmElements.createElement("navlist",{isSelector:!0,selectedId:N,items:[{id:"home",label:A.home,iconName:"__mdi:home",newTabUrl:"overview"},{id:"myforums",label:A.myforums,iconName:"__mdi:forum",newTabUrl:"myforums"},{label:cjBasics.lang.i18n("cj_i18n_01367","Starred topics"),iconName:"__mdi:star_outline",newTabUrl:"starred",external:!0},{label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),iconName:"__mdi:settings",newTabUrl:"usersettings/general",external:!0}],onChange:a,bmApis:n,onNewTab:function(e,n){r(n.newTabUrl)}});b.appendChild(e)}function i(){var e=[{id:"public",label:cjBasics.lang.i18n("cj_i18n_01368","Public groups"),iconName:"__mdi:public"}];v.domains.forEach(function(n){e.push({id:n,label:n,iconName:"__mdi:domain"})});var c=bmElements.createElement("navlist",{compact:!0,isSelector:!0,selectedId:L,items:e,onChange:function(e,c){L=e;var a=L&&"public"!==L;h.cjceSetServiceLabel(a?L:"Public groups"),cjgApis.cache.setItem(n.account,"bm_cache_v05__groups__domain",L),p.textContent="",d(L)}});f.textContent="",f.appendChild(c),bmElements.setLoading(f,!1)}function o(e,n,c){if(n){var a=mdElements.createElement("subheader",{label:n});p.appendChild(a)}var t=mdElements.createElement("list");v[e].forEach(function(e){var n=mdElements.createElement("item",{icon:{name:c||"__mdi:chat_bubble",color:y},label:e.label});n.addEventListener("click",function(){r(e.path)}),t.appendChild(n)}),p.appendChild(t)}function s(){p.textContent="";var e=!1;if("home"===N?(v.favorites.length&&(o("favorites",cjBasics.lang.i18n("cj_i18n_01369","Favorites")),e=!0),v.recentlyViewed.length&&(o("recentlyViewed",cjBasics.lang.i18n("cj_i18n_01370","Recently viewed")),e=!0),v.recentlyPosted.length&&(o("recentlyPosted",cjBasics.lang.i18n("cj_i18n_01371","Recently posted to")),e=!0)):"myforums"===N?v.myforums.length&&(e=!0,o("myforums")):"search"===N&&(v.savedSearches.length&&(o("savedSearches",cjBasics.lang.i18n("cj_i18n_01372","Saved searches"),"__mdi:saved_search"),e=!0),v.recentSearches.length&&(o("recentSearches",cjBasics.lang.i18n("cj_i18n_01373","Recent searches"),"__mdi:youtube_searched_for"),e=!0)),!e){var n=mdElements.createElement("emptystate",{color:y,label:"search"===N?null:cjBasics.lang.i18n("cj_i18n_00386","No groups found"),subLabel:"myforums"===N?cjBasics.lang.i18n("cj_i18n_00383","To add a new group, click the add button"):cjBasics.lang.i18n("cj_i18n_01374","Recent searches will appear here"),iconName:"search"===N?"__mdi:search":"__mdi:forum"});p.appendChild(n)}}function l(e){var c=S;return L&&"public"!==L&&(c+="/a/"+L),c+="/forum",B||(c+="?authuser="+n.account.authuser),c+"#!"+(e||"overview")}function r(e){n.openTab(l(e))}function m(n,c){v=n,k=n.domains.length>0,j.hidden=!k,c===L&&(bmElements.setLoading(e,!1),s(),i())}function d(a){bmElements.setLoading(e,!0);var t=!1;cjgApis.cache.getItem(n.account,"bm_cache_v05__groups__data__"+a).then(function(e){e&&!t&&m(e,a)}),c(a).then(function(e){t=!0,cjgApis.cache.setItem(n.account,"bm_cache_v05__groups__data__"+a,e),m(e,a)})}function u(){return cjgApis.cache.getItem(n.account,"bm_cache_v05__groups__domain").then(function(e){return e||cjgApis.info.getUserDomain(n.account).then(function(e){var c=e||"public";return cjgApis.cache.setItem(n.account,"bm_cache_v05__groups__domain",c),c})})}function _(){bmElements.setLoading(e,!0),h=bmElements.createElement("ogb",{darkMode:n.darkMode,drawer:{color:y},serviceIcon:"groups",serviceLabel:cjBasics.lang.i18n("cj_i18n_01368","Public groups"),pageLabel:A[N],searchbox:{collapsable:!0,color:y,onSubmit:function(e){r("search/"+encodeURIComponent(e))},submitInNewTab:!0},bmApis:n,onNewTab:function(){var e="myforums"===N?"myforums":"overview";r(e)},onBack:function(){a(T)}}),e.appendChild(h),E=h.cjceSearchboxEle,E.hidden=!0,w=mdElements.createElement("iconbutton",{iconName:"__mdi:search",onClick:function(){a("search")}}),h.cjceAppendChild(w),g=h.cjceNavigatorEle,b=h.cjceDrawerEle,f=bmElements.createElement("ogbdrawer"),bmElements.setLoading(f,!0),f.classList.add("cj-md-topdrawer--right"),h.appendChild(f),j=mdElements.createElement("iconbutton",{label:cjBasics.lang.i18n("cj_i18n_01375","Choose domain"),iconName:"__mdi:business",onClick:function(e){b.cjceToggle(!1),f.cjceToggle(),e.stopPropagation()}}),j.hidden=!0,h.cjceAppendChild(j),C=bmElements.createElement("fab",{darkMode:n.darkMode,label:cjBasics.lang.i18n("cj_i18n_00392","Create new group"),onClick:function(){r("creategroup")}}),C.hidden=!0,e.appendChild(C),p=mdElements.createElement("container",{darkMode:n.darkMode,scrollable:!0,shadow:"thinOnScroll"}),n.onPageDisplay(h.cjceSearchboxEle.select),e.appendChild(p),Promise.all([cjgApis.cache.getItem(n.account,"bm_cache_v05__groups__lastused"),u()]).then(function(e){var n=e[0];L=e[1],n&&n!==N&&(N=n,h.cjceSetPageLabel(A[N])),C.hidden="myforums"!==N;var c=L&&"public"!==L;c&&(h.cjceSetServiceLabel(L),j.hidden=!1),d(L)}),t(),cjgApis.login.getLoginEmail("groups").then(function(e){var c=n.account.displayEmail;c&&c===e&&(B=!0)})}var h,p,g,b,f,j,v,E,w,C,y="#1a73e8",S="https://groups.google.com",B=!1,k=!1,L="public",N="home",T=N,A={home:cjBasics.lang.i18n("cj_i18n_00291","Home"),myforums:cjBasics.lang.i18n("cj_i18n_00388","My groups"),search:cjBasics.lang.i18n("cj_i18n_01366","Searches")};_()}});