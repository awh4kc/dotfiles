cjModules.define(function(){"use strict";return function(e,a){function i(e){var a='gv-nav-tab[view-type="/'+e+'"] > div';"credits"===e?(t.cjceSelectedId="settings",m="settings",a='gv-nav-item[ng-if*="obs_isCreditVisible"], gv-nav-item[ng-click*="onCreditClick"]'):"markallasread"===e?(t.cjceSelectedId=m,a='gv-nav-item[ng-click*="onMarkAllAsRead"]'):m=e,w.cjceSendFrameCommand({method:"bmClickDomElement",value:a},l)}function n(){return cjBasics.ajax(r+"request/user?hl="+cjBasics.lang.current,{fetchAs:"json"}).then(function(e){var a=e&&e.formattedCredit;if(a)return a;throw Error()},function(){throw Error()})}function c(e){var i=cjBasics.urlParams.attach(o+"search",{from:"[]",hl:cjBasics.lang.current,q:JSON.stringify(e.split(" "))});a.openTab(i)}function s(){w.getCleanUrl(l).then(function(e){var i=e||o;a.openTab(i)})}var t,l="https://voice.google.com",o=l+"/u/"+a.account.authuser+"/",r="https://www.google.com/voice/b/"+a.account.authuser+"/",d=Boolean(a.servicesDatabase.classicvoice);setTimeout(function(){d&&a.pageManager.navigate("classicvoice")},1e3);var m="calls",b=m,g="#00897b",u={calls:{iconName:"__mdi:call",label:cjBasics.lang.i18n("cj_i18n_01170","Calls"),newTabUrl:!0},messages:{iconName:"__mdi:message",label:cjBasics.lang.i18n("cj_i18n_01128","Messages"),newTabUrl:!0},voicemail:{iconName:"__mdi:voicemail",label:cjBasics.lang.i18n("cj_i18n_01129","Voicemail"),newTabUrl:!0,divider:!0},archive:{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_00821","Archive"),newTabUrl:!0},spam:{iconName:"__mdi:report",label:cjBasics.lang.i18n("cj_i18n_00306","Spam"),newTabUrl:!0,divider:!0},markallasread:{iconName:"__mdi:sweep",label:cjBasics.lang.i18n("cj_i18n_01173","Mark all as read"),divider:!0},credits:{iconName:"__mdi:account_balance_wallet",label:cjBasics.lang.i18n("cj_i18n_00398","Credits"),newTabUrl:!0},settings:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0}},_=bmElements.createElement("ogb",{drawer:{color:g},searchbox:{color:g,onSubmit:c,submitInNewTab:!0},serviceIcon:"voice",serviceLabel:cjBasics.lang.i18n("cj_i18n_00443","Voice"),pageLabel:cjBasics.lang.i18n("cj_i18n_00291","Home"),bmApis:a,onNewTab:s});e.appendChild(_);var v=(_.cjceNavigatorEle,_.cjceSearchboxEle);a.onPageDisplay(v.select);var j=_.cjceDrawerEle;t=bmElements.createElement("navlist",{isSelector:!0,items:u,selectedId:m,onChange:i,onNewTab:function(e){var i=o+e;"credits"===e&&(i=o+"settings#payments"),a.openTab(i)}}),j.appendChild(t),j.classList.add("bm-p-newvoice-drawer");var p=bmElements.createElement("ogb",{displayBack:!0,floating:!0,serviceLabel:cjBasics.lang.i18n("cj_i18n_00443","Voice"),pageLabel:cjBasics.lang.i18n("cj_i18n_01174","Loading")+"...",searchbox:{color:g,onSubmit:c,submitInNewTab:!0},bmApis:a,onNewTab:s,onBack:function(){i(m),p.hidden=!0,"signup"===b&&(w.src="about:blank",setTimeout(function(){w.src=f}))}});p.hidden=!0,e.appendChild(p),n().then(function(e){e&&e.length>1&&(t.cjceGetItemEle("credits").dataset.creditcount=e)});var f=cjBasics.urlParams.attach(o,{bm_cid:"newvoice",bm_xfo:a.sid,bm_cst:"1",hl:cjBasics.lang.current}),h=cjBasics.webRequest.addListener("onBeforeRequest",function(i){d=!1,e.textContent="";var n=bmElements.createElement("fulldialog",{darkMode:a.darkMode,bmApis:a,onNewTab:function(){a.openTab(o)},lockup:{label:cjBasics.lang.i18n("cj_i18n_00443","Voice")},iconName:"voice",message:cjBasics.lang.i18n("cj_i18n_01175","You are not signed up to Voice yet"),actionLabel:cjBasics.lang.i18n("cj_i18n_00337","Sign up"),action:function(){a.openTab(o+"signup")}});return e.appendChild(n),h.removeListener(),{redirectUrl:"about:blank"}},{urls:[o+"about"]},["blocking"]),w=bmElements.createElement("iframe",{src:f,solid:!0,shadow:!0,onMessage:function(e){var a=e.bm_method,i=e.bm_value;if("frameCstLoaded"===a)d=!1;else if("newvoiceWebsiteTitle"===a)p.cjceSetPageLabel(i);else if("newvoiceUpdateView"===a&&i){var n="back"===i||"signup"===i;if(p.hidden=!n,b=i,!n){m=i,t.cjceSelectedId=i;var c=u[i].label;_.cjceSetPageLabel(c)}}}});e.appendChild(w)}});