cjModules.define(function(){"use strict";return function(e,n){function a(e,a){var t="https://www.google.com/adsense/new/",s=n.account.authuser;return w?t+="u/"+s+"/"+w+"/":"0"!==s&&null===w&&(a=a||{},a.authuser=s),t+=e||"home",a?cjBasics.urlParams.attach(t,a):t}function t(e,t){var s=a(e,t);n.openTab(s)}function s(e,a){var t=a||{};t.prettyPrint="false";var s=cjBasics.urlParams.attach(P+e,t);return cjgApis.request(s,{fetchAs:"json"},{account:n.account,internal:"optional",requiredScopes:A})["catch"](o)}function i(a){if(!y){y=!0,e.textContent="";var s=bmElements.createElement("fulldialog",{darkMode:n.darkMode,bmApis:n,onNewTab:function(){t("home")},lockup:{label:cjBasics.lang.i18n("cj_i18n_00179","AdSense")},iconName:"ad_sense",message:a.message,actionLabel:a.actionLabel,action:a.action});e.appendChild(s)}}function c(){i({message:cjBasics.lang.i18n("cj_i18n_00233","There is no AdSense account attached to this Google account"),actionLabel:cjBasics.lang.i18n("cj_i18n_00234","Change account"),action:function(){n.pageManager.navigate("accountchooser")}})}function r(e){i({message:cjBasics.lang.i18n("cj_i18n_00235","Before you can use this page, you need to give access to load your Google AdSense data"),actionLabel:cjBasics.lang.i18n("cj_i18n_01178","Continue"),action:function(){cjgApis.auth.requestPermissions(n.account,e.cjg_missing_scopes)}})}function o(e){return e&&e.body&&e.body.indexOf("noAdSenseAccount")?c():void("not_authorized"===e.cjg_error&&r(e))}function d(e){if(!w)throw c(),new Error("No AdSense Account");return s("accounts/"+w+"/reports",{startDate:e.start,endDate:e.end,metric:"EARNINGS",useTimezoneReporting:!0,fields:"headers/currency,totals"}).then(function(e){return{revenue:e.totals[0]||0,currency:e.headers[0].currency}})}function l(e,a){var t="bm_cache_v05_adsense__reports__"+e.start+"__"+e.end,s=!1;cjgApis.cache.getItem(n.account,t).then(function(e){!s&&e&&a(e)}),E.then(function(){C[t]=!0;var n=[d(e)];return e.previous&&n.push(d(e.previous)),Promise.all(n)}).then(function(e){s=!0,a(e),cjgApis.cache.setItem(n.account,t,e)},function(){})}function m(){return s("accounts",{fields:"items/id"},o).then(function(e){return e&&Array.isArray(e.items)&&0!==e.items.length?e.items[0].id:null})}function u(e){return e>0?"up":e<0?"down":"neutral"}function _(e,n){var a=Math.round(1e3*(e/n-1))/10;return(a>0?"+":"")+a+"%"}function p(e,n){var a=(Math.round(100*Math.abs(e))/100).toString(),t=a.split(".")[1];return t?t.length<2&&(a+="0"):a+=".00",a+" "+n}function h(e){var n=mdElements.createElement("card",{withPadding:!0,interactive:!0});n.addEventListener("click",function(){t("main/viewreports",{rt:"d",uim:"d",d:e.reportId,ct:e.reportCt||null})}),n.classList.add("bm-p-adsense-card");var a=document.createElement("div");a.className="bm-p-adsense-card__date",a.textContent=e.title,n.appendChild(a);var s=document.createElement("div");s.className="bm-p-adsense-card__amount",s.textContent=cjBasics.lang.i18n("cj_i18n_01174","Loading")+"...",n.appendChild(s);var i;if(e.previous){var c=document.createElement("div");c.className="cj-md-secondarytext bm-p-adsense-card__comparison",c.textContent=e.previous.title,a.appendChild(c),i=document.createElement("div"),i.className="bm-p-adsense-card__change",i.textContent="⁣",n.appendChild(i)}return l(e,function(n){var a=n[0].revenue,t=n[0].currency;if(s.textContent=a+" "+t,e.previous&&n[1]){var c=n[1].revenue,r=n[1].currency;if(r===t){var o=a-c,d=u(o),l=document.createDocumentFragment(),m=mdElements.createElement("icon",{name:"down"===d?"__mdi:trending_down":"__mdi:trending_up"});m.classList.add("bm-p-adsense-card__changeicon"),l.appendChild(m);var h=_(a,c),g=p(o,t),j=g+" ("+h+")",v=document.createElement("span");v.className="bm-p-adsense-card__changetext",v.textContent=j,l.appendChild(v),i.textContent="",i.dataset.type=d,i.appendChild(l)}}}),n}function g(){var e=document.createDocumentFragment();N.forEach(function(n){var a=h(n);e.appendChild(a)}),b.textContent="",b.appendChild(e)}function j(){var e=bmElements.createElement("navlist",{items:[{id:"home",iconName:"__mdi:home",label:cjBasics.lang.i18n("cj_i18n_00291","Home"),newTabUrl:!0,adsensePath:"home"},{iconName:"__mdi:picture_in_picture",label:cjBasics.lang.i18n("cj_i18n_01148","Ads"),newTabUrl:!0,adsensePath:"main/myads-viewall-adunits",adsenseParams:{product:"SELF_SERVICE_CONTENT_ADS"},external:!0},{iconName:"__mdi:admob",label:cjBasics.lang.i18n("cj_i18n_00580","AdMob"),newTabUrl:!0,adsensePath:"main/adMob",adsenseParams:{product:"SELF_SERVICE_G_MOB_DISPLAY_APP"},external:!0},{iconName:"__mdi:campaign_search_display",label:cjBasics.lang.i18n("cj_i18n_01149","Ads for search"),newTabUrl:!0,adsensePath:"main/myads-viewall-adunits",adsenseParams:{product:"SELF_SERVICE_SEARCH_ADS"},external:!0},{iconName:"__mdi:web",label:cjBasics.lang.i18n("cj_i18n_01150","Sites"),newTabUrl:!0,adsensePath:"sites/my-sites",external:!0,divider:!0},{iconName:"__mdi:block",label:cjBasics.lang.i18n("cj_i18n_01151","Blocking controls"),newTabUrl:!0,adsensePath:"main/allowAndBlockAds",external:!0},{iconName:"__mdi:assessment",label:cjBasics.lang.i18n("cj_i18n_01152","Reports"),newTabUrl:!0,adsensePath:"main/viewreports",adsenseParams:{rt:"d",uim:"d"},external:!0},{iconName:"__mdi:trending_up",label:cjBasics.lang.i18n("cj_i18n_01153","Optimalization"),newTabUrl:!0,adsensePath:"opt/opportunities",external:!0,divider:!0},{iconName:"__mdi:payments",label:cjBasics.lang.i18n("cj_i18n_01154","Payments"),newTabUrl:!0,adsensePath:"payments",external:!0},{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0,adsensePath:"settings",external:!0}],selectedId:"home",bmApis:n,onNewTab:function(e,n){t(n.adsensePath,n.adsenseParams)}});f.appendChild(e)}function v(){var a=bmElements.createElement("ogb",{darkMode:n.darkMode,drawer:{color:B},serviceIcon:"ad_sense",serviceLabel:cjBasics.lang.i18n("cj_i18n_00179","AdSense"),pageLabel:cjBasics.lang.i18n("cj_i18n_00291","Home"),bmApis:n,onNewTab:function(){t("home")}});e.appendChild(a),f=a.cjceDrawerEle;var s=mdElements.createElement("iconbutton",{iconName:"__mdi:refresh",label:cjBasics.lang.i18n("cj_i18n_01182","Refresh reports"),onClick:function(){f.cjceToggle(!1),cjgApis.cache.remove(n.account,Object.keys(C)).then(g)}});a.cjceAppendChild(s),j(),b=mdElements.createElement("container",{darkMode:n.darkMode,scrollable:"noScroll",shadow:"transparentOnScroll"}),e.appendChild(b),E=m().then(function(e){w=e,w||c()}),g()}var b,f,y,w,E,B="#1a73e8",C={},A=["https://www.googleapis.com/auth/adsense.readonly"],P="https://www.googleapis.com/adsense/v1.4/",N=[{title:cjBasics.lang.i18n("cj_i18n_00225","Today so far"),reportId:"today",start:"today",end:"today"},{title:cjBasics.lang.i18n("cj_i18n_00226","Yesterday"),reportId:"yesterday",start:"today-1d",end:"today-1d",previous:{title:cjBasics.lang.i18n("cj_i18n_00227","vs same day last week"),start:"today-8d",end:"today-8d"}},{title:cjBasics.lang.i18n("cj_i18n_00228","This month so far"),reportId:"thismonth",start:"startOfMonth",end:"today",previous:{title:cjBasics.lang.i18n("cj_i18n_01179","vs same period last year"),start:"startOfMonth-1y",end:"today-1y"}},{title:cjBasics.lang.i18n("cj_i18n_01181","Last 28 days"),start:"today-28d",end:"today-1d",reportId:"last30days",previous:{title:cjBasics.lang.i18n("cj_i18n_01180","vs previous 28 days"),start:"today-48d",end:"today-29d"}},{title:cjBasics.lang.i18n("cj_i18n_00232","Lifetime"),reportId:"alltime",reportCt:"tm",start:"today-100y",end:"today"}];v()}});