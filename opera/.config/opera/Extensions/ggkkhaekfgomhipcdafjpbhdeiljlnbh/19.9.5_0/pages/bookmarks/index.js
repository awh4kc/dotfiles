cjModules.define(function(){"use strict";return function(e,a){function t(){return cjgApis.cache.getItem(a.account,"bm_cache_v05__bookmarks__bookmarks").then(function(e){return e||{bookmarks:[],labels:[]}})}function n(e){a.openTab("https://www.google.com/bookmarks/find?authuser="+a.account.authuser+"&q="+e)}function l(){var e=cjBasics.urlParams.attach("https://www.google.com/bookmarks/lookup",{start:"0",num:"1000000000",hl:cjBasics.lang.current,authuser:a.account.authuser});return cjBasics.ajax(e).then(function(e){function t(e){s[e]||(s[e]={iconName:"__mdi:label",label:e,newTabUrl:cjBasics.urlParams.attach("https://www.google.com/bookmarks/lookup",{authuser:a.account.authuser,q:'label:"'+e+'"'})})}for(var n='id="search">',l=e.indexOf(n)===-1?"":e.split(n)[1].split('<div style="text-align: center;"')[0],o=new window.DOMParser,c=o.parseFromString(l,"text/html"),r=c.querySelectorAll('div[id] > span[id*="bkmk_view_"]'),s={_bm_all:{iconName:"__mdi:home",label:b,newTabUrl:"https://www.google.com/bookmarks/?authuser="+a.account.authuser}},i=[],m=0;m<r.length;m++){var u=r[m],d=u.querySelector('[id*="bkmk_info_"]'),h=d?d.textContent:"",k=["_bm_all"];if(d)for(var _=d.querySelectorAll("span > a"),p=0;p<_.length;p++)k.push(_[p].textContent);else k.push("_bm_unlabeled");k.forEach(t),i.push({url:cjBasics.urlParams.get(u.querySelector('[id*="bkmk_href_"]').href).q,title:u.querySelector('[id*="bkmk_href_"]').textContent,timestamp:parseInt(u.querySelector("script").textContent.split("_tsRender(")[1].split(",")[0],10),labels:k,labelsText:h})}s._bm_unlabeled={iconName:"__mdi:label",label:cjBasics.lang.i18n("cj_i18n_00369","Unlabeled"),newTabUrl:cjBasics.urlParams.attach("https://www.google.com/bookmarks/lookup",{authuser:a.account.authuser,q:"label:^none"})};var g={bookmarks:i,labels:s};return cjgApis.cache.setItem(a.account,"bm_cache_v05__bookmarks__bookmarks",g),g})}function o(e){var t=mdElements.createElement("item");t.addEventListener("click",function(){a.openTab(e.url)}),t.bookmarkLabels=e.labels;var n=mdElements.createElement("icon",{favicon:e.url});t.appendChild(n);var l=document.createElement("div");l.className="cj-md-item__body";var o=document.createElement("div");o.className="cj-md-item__header",o.textContent=e.title,l.appendChild(o);var c=document.createElement("div");c.className="cj-md-secondarytext";var r=[];if(e.labelsText&&r.push(e.labelsText),e.timestamp){var s=cjBasics.datetime.printDateString(e.timestamp);r.push(cjBasics.lang.i18n("cj_i18n_00007","Added")+": "+s)}return c.textContent=r.join(" - "),l.appendChild(c),t.appendChild(l),t}function c(t,n){var l=t.bookmarks,c=t.labels;if(!n){var r=Object.keys(c),b=r[r.length-1];c[b].divider=!0,c.manageLabels={iconName:"__mdi:settings",newTabUrl:"https://www.google.com/bookmarks/mark?op=editl&authuser="+a.account.authuser,label:cjBasics.lang.i18n("cj_i18n_00010","Manage labels"),external:!0},c.exportBookmarks={iconName:"__mdi:file_download",newTabUrl:"https://www.google.com/bookmarks/bookmarks.html?hl="+cjBasics.lang.current+"authuser="+a.account.authuser,label:cjBasics.lang.i18n("cj_i18n_01251","Export bookmarks"),external:!0},c.deleteBookmarks={iconName:"__mdi:delete",newTabUrl:"https://www.google.com/bookmarks/edit?ceh=1&authuser="+a.account.authuser,label:cjBasics.lang.i18n("cj_i18n_01252","Delete all"),external:!0},m=bmElements.createElement("navlist",{isSelector:!0,selectedId:"_bm_all",items:c,onChange:function(e){u.cjceSetPageLabel(c[e].label);for(var a=s.querySelectorAll(".cj-md-item"),t=0;t<a.length;t++){var n=a[t];n.hidden=n.bookmarkLabels.indexOf(e)===-1}},onNewTab:function(e,t){a.openTab(t.newTabUrl)}}),i.appendChild(m)}if(s.textContent="",0===l.length){var h=mdElements.createElement("emptystate",{color:d,label:cjBasics.lang.i18n("cj_i18n_00370","No bookmarks found"),subLabel:cjBasics.lang.i18n("cj_i18n_00371","To add a bookmark, click the add button at the bottom"),iconName:"__mdi:star_outline"});s.appendChild(h)}else{var k=mdElements.createElement("list");l.forEach(function(e){var a=o(e);k.appendChild(a)}),s.appendChild(k)}n||bmElements.setLoading(e,!1)}function r(){bmElements.setLoading(e,!0),u=bmElements.createElement("ogb",{darkMode:a.darkMode,serviceIcon:"bookmarks",serviceLabel:cjBasics.lang.i18n("cj_i18n_00190","Bookmarks"),pageLabel:b,searchbox:{color:d,onSubmit:n,submitInNewTab:!0},drawer:{color:d},bmApis:a,onNewTab:function(){var e=null,t=m&&m.cjceSelectedId;t&&"_bm_all"!==t&&(e="label:"+t),"_bm_unlabeled"===t&&(e="label:^none");var n=cjBasics.urlParams.attach("https://www.google.com/bookmarks/lookup",{authuser:a.account.authuser,q:e});a.openTab(n)}}),e.appendChild(u),a.onPageDisplay(u.cjceSearchboxEle.select),i=u.cjceDrawerEle;var o=bmElements.createElement("fab",{darkMode:a.darkMode,label:cjBasics.lang.i18n("cj_i18n_00009","Add bookmark"),onClick:function(){a.openTab("https://www.google.com/bookmarks/mark?op=add&authuser="+a.account.authuser)}});e.appendChild(o),s=mdElements.createElement("container",{darkMode:a.darkMode,scrollable:!0,shadow:"thinOnScroll"}),e.appendChild(s),t().then(function(e){c(e,!0)}),l().then(c)}var s,i,m,u,d="#1a73e8",b=cjBasics.lang.i18n("cj_i18n_01250","All items");r()}});