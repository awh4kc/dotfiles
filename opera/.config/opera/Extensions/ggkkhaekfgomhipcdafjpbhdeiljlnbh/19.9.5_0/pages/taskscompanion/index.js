cjModules.define(function(){"use strict";return function(e,a){function s(){var e=cjgShortcuts.getUrl("140",a.account);a.openTab(e)}function t(e){if(e.startsWith(n)){if(e.indexOf("#all/")!==-1){var s=e.split("#all/")[1],t=cjBasics.numbers.hex2dec(s),o=cjgApis.url.gmailThread.encode({threadId:t,messageId:t});e=e.split("#all/")[0]+"#all/"+o}a.openTab(e)}}bmElements.setLoading(e,!0);var n="https://mail.google.com",o="I0_"+Date.now(),i=cjBasics.urlParams.attach(n+"/tasks/embed",{bm_cid:"taskscompanion-gate",bm_xfo:a.sid,hl:cjBasics.lang.current,id:o,parent:window.location.origin,authuser:a.account.authuser}),c=bmElements.createElement("iframe",{src:i,solid:!0,onMessage:function(a){var s=a.bm_method,n=a.bm_value;a.bm_instance===o&&("taskscompanionOpenMail"===s?t(n):"taskscompanionLoaded"===s&&bmElements.setLoading(e,!1))}});cjBasics.webRequest.addListener("onHeadersReceived",function(e){var a=e.responseHeaders.filter(function(e){return"x-frame-options"!==e.name.toLowerCase()});return a.forEach(function(e){"content-security-policy"===e.name.toLowerCase()&&(e.value=e.value.replace(";frame-ancestors https://mail.google.com",""))}),{responseHeaders:a}},{types:["sub_frame"],urls:["https://tasks.google.com/embed/list*bm_cid=taskscompanion-webapp*_gfid="+o+"*","https://tasks.google.com/u/"+a.account.authuser+"/embed/list*bm_cid=taskscompanion-webapp*_gfid="+o+"*"]},["blocking","responseHeaders"]);var r=document.createElement("div");r.classList.add("bm-p-taskscompanion-tools");var l=bmElements.createElement("ogbtools",{onNewTab:s,bmApis:a});r.appendChild(l),e.appendChild(r),e.appendChild(c)}});