cjModules.define(function(){"use strict";return function(e,n){function t(){return N||(N=Promise.all([browserStorage.sync.getItem("bm_pref__news__edition"),cjBasics.resources.loadStyle("styles/cjg-news.css"),cjBasics.resources.loadScript("scripts/cjg-news.js")]).then(function(e){T=e||T||"auto"})),N}function a(e){var t="publications/";"TOPIC"===e.kind&&(t="topics/");var a=x+t+e.id;n.openTab(a)}function c(e){v.textContent="";var a=mdElements.createElement("container");v.appendChild(a),t().then(function(){var t=cjgNews.createNewsList({q:e,ned:T,shadow:"transparentOnScroll",onItemClick:n.openTab});a.appendChild(t)})}function i(e){var t=cjBasics.urlParams.attach("https://newsstand.google.com/"+e,{hl:cjBasics.lang.current,authuser:n.account.authuser});return cjBasics.ajax(t).then(function(e){var n=JSON.parse(e.replace(")]}',",""));return n.data.items||[]})}function r(e){var n=mdElements.createElement("griditem");n.addEventListener("click",function(){a(e)});var t=document.createElement("div");t.className="bm-p-news-item__thumbnail";var c=e.icon&&e.icon.image.url;c&&(t.style.backgroundImage='url("'+c+'")'),"TOPIC"===e.kind&&(t.style.backgroundColor=e.theme.background),n.appendChild(t);var i=document.createElement("div");i.className="cj-md-grid__item__bottom",n.appendChild(i);var r=document.createElement("div");r.className="cj-md-grid__item__textcontainer",i.appendChild(r);var s=document.createElement("div");return s.textContent=e.title,r.appendChild(s),n}function s(e,n){if(0===e.length)return mdElements.createElement("emptystate",{color:S,label:cjBasics.lang.i18n("cj_i18n_01342","No items found"),iconName:"__mdi:news"});for(var t=document.createDocumentFragment(),a=0;a<e.length;a++){var c=e[a],i="SAVED_SEARCH"===c.kind;if(n===i){var s=r(e[a]);t.appendChild(s)}}return t}function l(t){bmElements.setLoading(e,!0),v.textContent="";var a=mdElements.createElement("container",{scrollable:!0,shadow:"transparentOnScroll"});v.appendChild(a);var c=mdElements.createElement("gridcontainer");a.appendChild(c);var r="";cjgApis.cache.getItem(n.account,"bm_cache_v05__news__library").then(function(e){if(Array.isArray(e)){r=JSON.stringify(e);var n=s(e,t);c.appendChild(n)}}),i("api/library/subscriptions").then(function(a){if(bmElements.setLoading(e,!1),JSON.stringify(a)!==r){c.textContent="",cjgApis.cache.setItem(n.account,"bm_cache_v05__news__library",a);var i=s(a,t);c.appendChild(i)}})}function o(e){var n=mdElements.createElement("griditem");n.addEventListener("click",function(){a(e)});var t=document.createElement("div");t.className="bm-p-news-item__thumbnail bm-p-news-item__thumbnail--tall",t.style.backgroundImage='url("'+e.image.url+'")',"TOPIC"===e.kind&&(t.style.backgroundColor=e.theme.background),n.appendChild(t);var c=document.createElement("div");c.className="cj-md-grid__item__bottom",n.appendChild(c);var i=document.createElement("div");i.className="cj-md-grid__item__textcontainer",c.appendChild(i);var r=document.createElement("div");r.textContent=e.magazineTitle.title,i.appendChild(r);var s=document.createElement("div");return s.className="cj-md-secondarytext",s.textContent=e.title,i.appendChild(s),n}function d(e){if(0===e.length)return mdElements.createElement("emptystate",{color:S,label:cjBasics.lang.i18n("cj_i18n_01342","No items found"),iconName:"__mdi:news"});for(var n=document.createDocumentFragment(),t=0;t<e.length;t++){var a=o(e[t]);n.appendChild(a)}return n}function m(){bmElements.setLoading(e,!0),v.textContent="";var t=mdElements.createElement("container",{scrollable:!0,shadow:"transparentOnScroll"});v.appendChild(t);var a=mdElements.createElement("gridcontainer");t.appendChild(a);var c="";cjgApis.cache.getItem(n.account,"bm_cache_v05__news__magazines").then(function(e){if(Array.isArray(e)){c=JSON.stringify(e);var n=d(e);a.appendChild(n)}}),i("api/library/magazines").then(function(t){if(bmElements.setLoading(e,!1),JSON.stringify(t)!==c){a.textContent="",cjgApis.cache.setItem(n.account,"bm_cache_v05__news__magazines",t);var i=d(t);a.appendChild(i)}})}function u(){var e=[],n=[],t=Object.keys(cjgNews.topics),a=t[0];return t.forEach(function(t,a){var c=cjgNews.topics[t];c.id=t,a<3?e.push(c):n.push(c)}),{firstId:a,primary:e,secondary:n}}function p(){function a(){s.textContent="";var e=cjgNews.createNewsList({q:i,ned:T,topic:c,shadow:"thinOnScroll",onItemClick:n.openTab});s.appendChild(e)}bmElements.setLoading(e,!0);var c="HEADLINE",i="";v.textContent="";var r=mdElements.createElement("appbar",{secondary:!0});v.appendChild(r);var s=mdElements.createElement("container");v.appendChild(s),t().then(function(t){var i=u(),s=mdElements.createElement("tabs",{fill:!0,items:i.primary,onAltClick:function(e){var t=cjgNews.topics[e].newTabUrl;n.openTab(t)},onChange:function(e){c=e,a()},selected:i.firstId}),l=bmElements.createElement("menu",{variant:"tabs",hidden:!0,items:i.secondary,onClick:function(e,n){c=e;var t=s.querySelector(":scope > :nth-child(4)"),i=t.dataset.id;n.dataset.id=i,n.textContent=cjgNews.topics[i].label,t.dataset.id=e,t.textContent=cjgNews.topics[e].label,s.selected=e,a()}}),o=document.createElement("div");o.className="cj-md-tabs__item cj-md-tabs__arrow",o.addEventListener("click",function(e){l.cjceToggleState(),e.stopPropagation()}),o.textContent=cjBasics.lang.i18n("cj_i18n_00047","More"),o.appendChild(l),s.appendChild(o),r.appendChild(s),bmElements.setLoading(e,!1),a()})}function g(){"headlines"===k?p():"library"===k?l(!1):"searches"===k?l(!0):m()}function _(){var e=bmElements.createElement("navlist",{isSelector:!0,selectedId:"headlines",items:I,onChange:function(e,n){k=e;var t=I[e].label;j.cjceSetPageLabel(t),g()},onNewTab:function(e,t){n.openTab(t.newTabUrl)}});f.appendChild(e),t().then(function(){var e=bmElements.createElement("drawerdropdown",{iconName:"__mdi:language",label:cjBasics.lang.i18n("cj_i18n_01343","Change edition"),selectedId:T,items:cjgNews.neds,onChange:function(){var n=e.cjceSelectedId;browserStorage.sync.setItem("bm_pref__news__edition",n),T=n,p()}});f.appendChild(e)})}function h(e){var t=Date.now();cjgApis.suggestquery.get({gAccount:n.account,hl:cjBasics.lang.current,q:e,ds:"n"}).then(function(e){if(!(y>t)){if(y=t,w.textContent="",!e)return void E.cjceToggleState(!1);f.cjceToggle(!1);for(var n=0;n<e.length;n++){var a=e[n],c=mdElements.createElement("item");c.dataset.value=a.value,c.appendChild(a.html),w.appendChild(c)}E.cjceToggleState(!0)}})}function b(){j=bmElements.createElement("ogb",{darkMode:n.darkMode,drawer:{color:S},serviceIcon:"news",serviceLabel:cjBasics.lang.i18n("cj_i18n_00425","News"),pageLabel:I[k].label,searchbox:{color:S,searchmenu:!0,onClear:function(){E.cjceToggleState(!1),g()},onInput:function(e){h(e)},onSubmit:function(e){f.cjceToggle(!1),E.cjceToggleState(!1),c(e)},onSubmitAlt:function(e){var t=cjBasics.urlParams.attach("https://www.google.com/search",{q:e,tbm:"nws",authuser:n.account.authuser});n.openTab(t)}},bmApis:n,onNewTab:function(){var e=I[k].newTabUrl;n.openTab(e)}}),e.appendChild(j),f=j.cjceDrawerEle,_(),C=j.cjceSearchboxEle,E=C.cjceSearchmenuEle,n.onPageDisplay(C.select),w=mdElements.createElement("list"),w.classList.add("bm-ele-autocomplete"),w.addEventListener("click",function(e){E.cjceToggleState(!1);var n=e.target.dataset.value;C.value=n,c(n)}),E.appendChild(w),v=mdElements.createElement("container",{darkMode:n.darkMode}),e.appendChild(v),g()}var v,f,j,E,C,w,y,N,S="#1a73e8",T="auto",k="headlines",x="https://news.google.com/"+n.wizPath,I={headlines:{label:cjBasics.lang.i18n("cj_i18n_00020","Top Stories"),iconName:"__mdi:play_newsstand",newTabUrl:x},foryou:{label:cjBasics.lang.i18n("cj_i18n_01055","For you"),iconName:"__mdi:for_you",newTabUrl:x+"foryou",external:!0},library:{label:cjBasics.lang.i18n("cj_i18n_01339","Topics/sources"),iconName:"__mdi:star_outline",newTabUrl:x+"my/library"},searches:{label:cjBasics.lang.i18n("cj_i18n_01340","Saved searches"),iconName:"__mdi:search",newTabUrl:x+"my/searches"},magazines:{label:cjBasics.lang.i18n("cj_i18n_00132","Magazines"),iconName:"__mdi:auto_stories",newTabUrl:x+"my/magazines"},bookmarks:{label:cjBasics.lang.i18n("cj_i18n_01341","Saved stories"),iconName:"__mdi:bookmark_border",newTabUrl:x+"my/bookmarks",external:!0,divider:!0}};b()}});