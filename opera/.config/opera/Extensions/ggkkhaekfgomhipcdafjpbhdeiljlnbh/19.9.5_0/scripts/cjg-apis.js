var cjgApis=function(){"use strict";var e="undefined"!=typeof chrome&&chrome.runtime?chrome:"undefined"!=typeof browser&&browser,t=e.i18n.getMessage("@@extension_id"),n=!0,r=window.atob,o=r("QUl6YVN5REZYNTVHNUloamVMTW1NeW92VUNvSk1VLWFpZk5jY3Y4"),a=r("NDk0MDg2MDMwODUxLTkzdmplNzc4a29ncjlkbmZxMmhobGkyZTkxOHA0aGhhLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29t"),i=function(){function t(t,r,o){e.runtime.getBackgroundPage(function(e){n.then(function(n){var a=n===-1||location.href.indexOf("environment=popup")!==-1,i=Math.round(a?window.screenTop:(window.screen.height-600)/2),u=Math.round(a?window.screenLeft:(window.screen.width-600)/2);e.createNewPopup(t,r,o,i,u,a)})})}var n=cjBasics.getTabId();return{create:t}}(),u=function(){function n(e){var t=cjBasics.urlParams.attach("https://www.googleapis.com/oauth2/v3/tokeninfo",{access_token:e,prettyPrint:"false"});return cjBasics.ajax(t,{fetchAs:"json"})}function r(e){var t=Date.now(),n=Number(e.expires_in);if(n)return t+n;var r=Number(e.exp);return r?1e3*r:t}function o(e){return e.pageId?"https://www.googleapis.com/auth/youtube.readonly":"https://www.googleapis.com/auth/userinfo.profile"}function i(e,t){var n={cjg_error:"not_authorized",cjg_missing_scopes:t};return Promise.reject(n)}function u(e,t,n){if(!t||!t.accessToken)return i(e,n);Array.isArray(n)||(n=[o(e)]);var r=[],a=t.grantedScopes||[];return n.forEach(function(e){a.indexOf(e)===-1&&r.push(e)}),r.length>0?i(e,r):t.accessToken}function c(i){return new Promise(function(u){function c(t){var o=t.split("#")[1];if(o){var i=cjBasics.urlParams.parse(o);if(i.state===l)if(g.remove(),p.removeListener(),f.removeListener(),cjBasics.navigator.vivaldi&&e.runtime.onMessage.removeListener(s),i.error)u(null);else{var c=i.access_token,h=n(c).then(function(e){return e.aud!==a?null:{accessToken:c,grantedScopes:e.scope?e.scope.split(" "):[],expireTime:r(e)}},function(){return null});u(h)}}}function s(e){e.cjgAuthUrl&&c(e.cjgAuthUrl)}var l=t+"---"+cjBasics.uniqueId.generate(),g=document.createElement("iframe"),f=cjBasics.webRequest.addListener("onBeforeRedirect",function(e){e.redirectUrl.indexOf("scope=")&&c(e.redirectUrl)},{types:["sub_frame"],urls:["https://www.google.com/cjg-auth/"+t+"*","https://accounts.google.com/*"+t+"*"]}),p=cjBasics.webRequest.addListener("onBeforeRequest",function(e){return c(e.url),{redirectUrl:"about:blank"}},{types:["sub_frame"],urls:["https://www.google.com/cjg-auth/"+t+"*"]},["blocking"]);cjBasics.navigator.vivaldi&&e.runtime.onMessage.addListener(s),g.style.display="none",g.src=cjBasics.urlParams.attach("https://accounts.google.com/o/oauth2/v2/auth",{authuser:i.authuser,client_id:a,include_granted_scopes:"true",pageId:i.pageId||null,prompt:"none",redirect_uri:h,response_type:"token",scope:o(i),state:l}),document.body.appendChild(g)})}function s(e,t){var n=e.pageId+"-"+e.obfuscatedId,r=d[n];if(r&&r.expireTime>Date.now()+1e4)return u(e,r,t);d[n]=null;var o=m[n];return o||(o=c(e),m[n]=o),o.then(function(r){return r&&(d[n]=r),u(e,r,t)})}function l(e,n){var r=Array.isArray(n)?n:[],i=o(e);return r.indexOf(i)===-1&&r.push(i),cjBasics.urlParams.attach("https://accounts.google.com/o/oauth2/v2/auth",{hl:cjBasics.lang.current,authuser:e.authuser||"0",client_id:a,login_hint:e.displayEmail,pageId:e.pageId||null,redirect_uri:h,response_type:"token",scope:r.join(" "),state:t+"---permissionrequest"})}function g(e){var t=cjBasics.urlParams.attach("https://accounts.google.com/o/oauth2/revoke",{token:e});return cjBasics.ajax(t,{fetchAs:"json"})}function f(e){return s(e).then(g)}function p(e,n){var r=l(e,n),o="https://www.google.com/cjg-auth/"+t+"*";cjgApis.popup.create(r,o,"auth")}var h="https://g.carlosjeurissen.com/auth/",d={},m={};return{getTokenInfo:n,requestPermissions:p,revokePermissions:f,requireToken:s}}(),c=function(){function e(e,t){var n="https://www.youtube.com/";return t.indexOf("music.youtube.com")!==-1&&(n="https://music.youtube.com/"),cjgApis.session.noMultiAccountOrPage||!cjgApis.session.account.validSession?t?t.startsWith("http")?t:n+t:n:cjBasics.urlParams.attach(n+"signin",{feature:"masthead_switcher",action_handle_signin:"true",skip_identity_prompt:"True",pageid:e.pageId,authuser:e.authuser,next:t||null})}function t(e){var t=e&&e.authuser||"0";return"u/"+t+"/"}function n(e){var t="";return e&&e.authuser&&"0"!==e.authuser&&(t+="u/"+e.authuser+"/"),e&&e.pageId&&(t+="b/"+e.pageId+"/"),t}function r(e,t){var n=cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){var r=e.requestHeaders.filter(function(e){return"origin"!==e.name.toLowerCase()});return r.push({name:"Origin",value:t||"https://www.google.com"}),n.removeListener(),{requestHeaders:r}},{types:["xmlhttprequest"],urls:[e]},["blocking","requestHeaders"])}var o=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="BCDFGHJKLMNPQRSTVWXZbcdfghjklmnpqrstvwxz",n="thread-",r="msg-",o=function(e){return/^[\s\xa0]*$/.test(e)},a=function(e){return!!e&&(e.indexOf(n)!==-1||e.indexOf(r)!==-1)},i=function(r){return o(r)?r:(r=r.replace(n,""),c(window.btoa(r).replace(/=/g,""),e,t))},u=function(r){if(a(r)||!/^[BCDFGHJKLMNPQRSTVWXZbcdfghjklmnpqrstvwxz]*$/.test(r))return r;try{var o=window.atob(c(r,t,e));return o.indexOf(n)===-1?n+o:o}catch(i){return r}},c=function(e,t,n){if(!n)throw Error("rd");var r,o,a=t.length,i=n.length,u=!0;for(r=0;r<e.length;r++)if(e.charAt(r)!==t.charAt(0)){u=!1;break}if(u)return n.charAt(0);var c={};for(r=0;r<a;r++)c[t.charAt(r)]=r;var s=[];for(r=e.length-1;r>=0;r--){var l=e.charAt(r);if("undefined"==typeof c[l])throw Error("sd`"+e+"`"+t+"`"+l);s.push(c[l])}var g=[];for(r=s.length-1;r>=0;r--){var f=0;for(o=0;o<g.length;o++){var p=g[o]*a+f;if(p>=i){var h=p%i;f=(p-h)/i,p=h}else f=0;g[o]=p}for(;f;){var d=f%i;g.push(d),f=(f-d)/i}for(f=s[r],o=0;f;o++){o>=g.length&&g.push(0);var m=g[o]+f;if(m>=i){var v=m%i;f=(m-v)/i,m=v}else f=0;g[o]=m}}var w=[];for(r=g.length-1;r>=0;r--){var j=g[r];if(j>=n.length||j<0)throw Error("td`"+g+"`"+j);w.push(n.charAt(j))}return w.join("")};return{encode:function(e){var t=[];e.threadId&&t.push("thread-f:"+e.threadId),e.messageId&&t.push("msg-f:"+e.messageId);var n=t.join("|");return i(n)},decode:function(e){return u(e)}}}();return{youtube:e,gmailThread:o,createWizPath:n,createAccountPath:t,setRequestOrigin:r}}(),s=function(){function e(e){return cjBasics.ajax(e,{method:"POST",credentials:"include",fetchAs:"json"})}function n(e){return cjBasics.ajax(e+"&origin=https%3A%2F%2Fwww.google.com",{credentials:"include",fetchAs:"text"}).then(function(e){return JSON.parse(decodeURIComponent(e.split(".postMessage")[1].split("www.google.com")[0].replace(/\\x/g,"%").replace(/\\n/g,"")).slice(2,-14))})}function r(e){return e[1].map(function(e){return{displayName:e[2],displayEmail:e[3],photoUrl:e[4],authuser:e[7]?e[7].toString():"0",pageId:e[8],validSession:0!==e[9]&&e[9]!==!1,obfuscatedId:e[10],ownedBySelectedAccount:e[11]}})}function o(t){var o=t||{},a=Math.floor(1e3*Math.random());a<100&&(a+=103);var i="https://accounts.google.com/ListAccounts?json=standard&source=ogb&md=1&cc=1&mn=1&mo=1&gpsia=1&fwput="+a;return o.listPages!==!1&&(i+="&listPages=1"),o&&o.authuser&&(i+="&authuser="+o.authuser),o&&o.pageId&&(i+="&pageId="+o.pageId),Promise.resolve().then(function(){return cjgApis.url.setRequestOrigin(i),e(i)})["catch"](function(){return n(i)}).then(r)}function a(e,n,r){var o="https://www.google.com/cjg-apis/"+t+"_"+cjBasics.uniqueId.generate()+"/"+r,a=n||{};a["continue"]=o;var i=cjBasics.urlParams.attach("https://accounts.google.com/"+e,a),u=o+"*";return cjgApis.popup.create(i,u,r)}function i(e){return"string"==typeof e&&e.indexOf("@")!==-1&&e.length>2?e:null}function u(e){var t="AddSession";return e&&e.validSession===!1&&(t="AccountChooser"),a(t,{Email:i(e&&e.displayEmail)},"signin")}function c(){a("Logout",null,"signout")}var s={displayName:"Not signed in",authuser:"0",obfuscatedId:"ACCOUNT_ID_NONE",pageId:null,validSession:!1},l={displayName:"A Google user",photoUrl:"/images/avatar.svg",authuser:"0",obfuscatedId:"me",pageId:null,validSession:!0};return{noAccountData:s,missingAccountData:l,list:o,signin:u,signout:c}}(),l=function(){function e(){return n||(n=cjBasics.resources.loadScript("https://apis.google.com/js/api.js")),n}function t(t){return r[t]||(r[t]=e().then(function(){return new Promise(function(e){window.gapi.load(t,e)})}).then(function(){return window.gapi})),r[t]}if(cjBasics.navigator.firefox)return null;window.___gcfg=window.___gcfg||{},window.___gcfg.parsetags="explicit",window.___gcfg.lang=navigator.language;var n,r={};return{load:t,setLang:function(e){window.___gcfg.lang=e}}}(),g=function(){function e(e){return e.obfuscatedId+"-"+e.pageId+"-cjg_"}function t(t,n){return browserStorage.local.getItem(e(t)+"-"+n)}function n(t,n,r){return browserStorage.local.setItem(e(t)+"-"+n,r)}function r(t,n){var r,o=e(t);return r=Array.isArray(n)?n.map(function(e){return o+"-"+e}):o+"-"+n,browserStorage.local.remove(r)}return{getItem:t,setItem:n,remove:r}}(),f=function(){function e(e){var n=e||{};return t||(t=new Promise(function(e){var t="mapsPageApiCallback_"+cjBasics.uniqueId.generate();window[t]=function(){delete window[t],e(window.google&&window.google.maps)};var r=cjBasics.urlParams.attach("https://maps.googleapis.com/maps/api/js",{key:n.key,callback:t,language:n.lang});cjBasics.resources.loadScript(r)})),t}if(cjBasics.navigator.firefox)return null;var t;return{load:e}}(),p=function(){function e(e){if("string"!=typeof e)return null;var t=e;return t.startsWith("http:")&&(t=t.replace("http:","https:")),t.startsWith("//")&&(t=t.replace("//","https://")),t.startsWith("https://")||(t="https://"+t),t}function t(t){return t.iconUrl48x48&&(t.iconUrl48x48=e(t.iconUrl48x48)),t.iconUrl96x96&&(t.iconUrl96x96=e(t.iconUrl96x96)),t}function n(e){return cjgApis.info.getSource(e).then(function(e){var t=e.indexOf("/installedApps/");if(t===-1)return null;var n=e.split("/installedApps/")[1].split("?")[0];return n.length<150?n:e.slice(t+15,t+79)})}function r(e){var r=e||cjgApis.account.missingAccountData;return n(r).then(function(e){if(!e)return[];var n="https://www.googleapis.com/appsmarket/v2/installedApps/"+e+"?authuser="+r.authuser;return cjBasics.ajax(n,{fetchAs:"json"}).then(function(e){return e&&Array.isArray(e.installedApps)?e.installedApps.map(t):[]})})}return{getApps:r}}(),h=function(){function e(e,t){var n=new RegExp(t),r=e.match(n);return r?r[1]:null}function t(t){return cjgApis.info.getSource(t).then(function(n){var r=null;r||(r=e(n,"(u/\\d(?:/b/\\d{21})?/)_/og/botguard")),r||(r=e(n,"(u/\\d(?:/b/\\d{21})?/)_/notifications/count")),r||(r="u/"+t.authuser+"/"+(t.pageId?"b/"+t.pageId+"/":""));var o=null;return o||(o=e(n,'customization/remove",""]],"([\\w-]{20,200})"')),o||(o=e(n,'pages.plusgoogle.com","'+t.pageId+'","([\\w-]{20,200})"')),o||(o=e(n,'"'+t.displayEmail+'","","([\\w-]{20,200})"')),o||(o=e(n,'"([\\w-]{20,200})"')),{ogsPath:r,ntok:o}})}function n(e){var n=e||cjgApis.account.missingAccountData,r=n.pageId+"-"+n.authuser;return u[r]||(u[r]=t(n)),u[r]}function r(e,t,r){return n(e).then(function(e){var n="https://ogs.google.com/"+e.ogsPath+"_/"+t;n+=n.indexOf("?")===-1?"?":"&",n+="bm_ogs="+cjBasics.uniqueId.generate(),cjgApis.url.setRequestOrigin(n);var o={ntok:e.ntok};return r&&(o["f.req"]=r.replace("$OGS_NTOK",e.ntok)),cjBasics.ajax(n,{method:"POST",fetchAs:"text",credentials:"include",body:cjBasics.urlParams.create(o),headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"}}).then(function(e){try{return JSON.parse(e.replace(")]}'",""))}catch(t){return null}})})}function o(e){return r(e,"notifications/count").then(function(e){return e[0]},function(){return null})}function a(e){var t=JSON.stringify(["og.stoq","$OGS_NTOK"]);return r(e,"og/customization/get?rt=j",t).then(function(e){return e[0][0][2]})}function i(e,t){var n=JSON.stringify(["og.stoq","$OGS_NTOK",t]);return r(e,"og/customization/set?rt=j",n)}var u={};return{getNotificationsCount:o,getShortcuts:a,setShortcuts:i,getFreshOgsData:t}}(),d=function(){function t(){return new Promise(function(t){e.cookies.get({url:"https://www.google.com",name:"SAPISID"},function(e){t(e.value)})})}function r(e){return t().then(function(t){var n=Date.now(),r=e||"https://www.google.com",o=[n,t,r].join(" "),a=sha1(o);return"SAPISIDHASH "+n+"_"+a})}function o(e,t,n){return r(n.requiredOrigin).then(function(r){var o=e.replace("https://www.googleapis.com","https://clients6.google.com");o=o.replace("googleapis.com","clients6.google.com"),o=o.replace("https://www.google.com","https://clients6.google.com"),null!==n.key&&n.key!==!1&&(o=cjBasics.urlParams.inject(o,{key:n.key||cjgApis.session.key}));var a=n.account;t.credentials="include";var i=t.headers||{};return i.Authorization=r,i["x-goog-authuser"]=a.authuser,a.pageId&&(i["x-goog-pageid"]=a.pageId),t.headers=i,cjgApis.url.setRequestOrigin(o,n.requiredOrigin),cjBasics.ajax(o,t)})}function a(e,t,n){return cjgApis.auth.requireToken(n.account,n.requiredScopes).then(function(n){return t.headers=t.headers||{},t.headers.Authorization="Bearer "+n,cjBasics.ajax(e,t)})}function i(e,t,r){var i=r||{};i.account||console.error("cjgApis.request - missing account data"),i.account=i.account||cjgApis.account.missingAccountData;var u=t||{},c=i.internal,s="optional"!==c;if(c!==!0&&(!n||s))return a(e,u,i);var l=o(e,u,i);return s?l:l["catch"](function(){return a(e,u,i)})}return i}(),m=function(){function e(e){var t="https://aboutme.google.com/"+cjgApis.url.createWizPath(e)+"?hl=en";return cjBasics.ajax(t,{fetchAs:"text"})}function t(t){var n=t.pageId+"-"+t.authuser;return i[n]||(i[n]=e(t)),i[n]}function n(e){var t=e.displayEmail;return t?t.endsWith("@gmail.com")||t.endsWith("@googlemail.com"):null}function r(e){return!e.validSession||n(e)?Promise.resolve(null):t(e).then(function(e){var t;if(e.indexOf("domainName=")!==-1&&(t=e.split("domainName=")[1].split('"')[0],t.length>4&&t.length<200&&"gmail.com"!==t&&"googlemail.com"!==t))return t;if(e.indexOf("managed by")!==-1)t=e.split("managed by")[1];else{if(e.indexOf("gbpbt")===-1)return null;t=e.split("gbpbt")[1]}return t=t.split("<b>")[1].split("<")[0],t.length<200?t:null},function(){return null})}function o(e){return!e.validSession||n(e)?Promise.resolve(null):t(e).then(function(e){return e.indexOf('data-pid="199"')!==-1||e.indexOf("https://admin.google.com")!==-1})}function a(e){if(!e.validSession)return Promise.resolve(!1);var n=t(e).then(function(e){return e.indexOf("M4.02,28.27C2.73,25.8,2,22.98,2,20c0-2.87,0.68-5.59,1.88-8l-1.72-1.04C0.78,13.67,0,16.75,0,20c0,3.31,0.8,6.43,2.23,9.18L4.02,28.27z")!==-1}).then(function(t){return cjgApis.cache.setItem(e,"bm_cache_v05__account__one",t),t});return cjgApis.cache.getItem(e,"bm_cache_v05__account__one").then(function(e){return"boolean"==typeof e?e:n})}var i={};return{getSource:t,getIsConsumerGmail:n,getUserDomain:r,getIsAdmin:o,getIsOne:a}}(),v=function(){function t(t,n){r=t,browserStorage.local.setItem("bm_cache_v05__account__current",r),n||(e.runtime.sendMessage({reloadAllInstances:!0}),window.location.reload())}function n(){return f?p:(f=!0,browserStorage.local.getItem("bm_cache_v05__account__current").then(function(e){r=e||cjgApis.account.missingAccountData,g=cjgApis.url.createWizPath(r),i(r),c(cjgApis.account.list({authuser:r.authuser})),r.authuser&&"0"!==r.authuser&&r.validSession?u():d.then(function(e){if(!Array.isArray(e)||e.length<2)return l=!0,s=!0,void u();for(var t=0;t<e.length;t++)if("1"===e[t].authuser)return void u();s=!0,u()}),d.then(function(e){if(!Array.isArray(e)||0===e.length||!e[0].validSession)return void("ACCOUNT_ID_NONE"!==r.obfuscatedId&&t(cjgApis.account.noAccountData));for(var n=0;n<e.length;n++){var o=e[n];if(r.obfuscatedId===o.obfuscatedId&&r.pageId===o.pageId)return o.validSession?void(r.validSession&&r.displayEmail===o.displayEmail&&r.authuser===o.authuser?r.photoUrl===o.photoUrl&&r.displayName===o.displayName||t(o,!0):t(o)):void t(e[0])}t(e[0])})}),p)}var r,i,u,c,s=!1,l=!1,g="",f=!1,p=new Promise(function(e){i=e}),h=new Promise(function(e){u=e}),d=new Promise(function(e){c=e});return n(),{get key(){return o},get clientId(){return a},get account(){return r},get wizPath(){return g},get noMultiAccount(){return s},get noMultiAccountOrPage(){return l},accountsList:d,multiAccountCheckReady:h,changeAccount:t,init:n,ready:p}}(),w=function(){function t(t,n){return new Promise(function(r){e.cookies.get({name:t,url:n},function(e){r(e.value)})})}function n(e){if(!e)return null;var t=e.split("=")[1];return t.indexOf("@")===-1?null:t}function r(e){var r=o[e],a="https://"+e+".google.com";return t(r,a).then(n)}var o={groups:"groupsloginpref",play:"PLAY_ACTIVE_ACCOUNT",sites:"SITESM",store:"PLAY_ACTIVE_ACCOUNT"};return{getLoginEmail:r}}(),j=function(){function e(e){var t={amp:"&",lt:"<",le:"≤",gt:">",ge:"≥",quot:'"',"#039":"'"};return e.replace(/&([^;]+);/g,function(e,n){return t[n]||""})}function t(t){var n,r=e(t[0]),o=t[3];return o&&o.b&&o.c?(r+="– "+o.b,n=o.c):n=r.split(/<b>|<\/b>/g).join(""),{value:n,html:cjBasics.htmlToFragment(r.replace(/<i>|<\/i>/g,""))}}function n(e){var n=cjBasics.urlParams.attach("https://suggestqueries.google.com/complete/search",{client:"serp",authuser:e.gAccount?e.gAccount.authuser:null,xhr:"t",hl:e.hl,q:e.q,ds:e.ds});return cjBasics.ajax(n,{fetchAs:"json"}).then(function(e){var t=e[1];return Array.isArray(t)&&t.length>0?t:null}).then(function(e){return e?e.map(t):null})}return{get:n}}();return{account:s,auth:u,cache:g,info:m,maps:f,marketplace:p,module:l,ogs:h,popup:i,request:d,session:v,login:w,url:c,suggestquery:j}}();